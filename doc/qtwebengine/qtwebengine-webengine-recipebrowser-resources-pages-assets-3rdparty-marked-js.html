<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>marked.js Example File | Qt WebEngine 5.9</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
  <div class="main">
    <div class="main-rounded">
      <div class="navigationbar">
        <table><tr>
<td >Qt 5.9</td><td ><a href="qtwebengine-index.html">Qt WebEngine</a></td><td ><a href="qtwebengine-webengine-recipebrowser-example.html">WebEngine Recipe Browser</a></td><td >marked.js Example File</td></tr></table><table class="buildversion"><tr>
<td id="buildversion" width="100%" align="right">Qt 5.9.5 Reference Documentation</td>
        </tr></table>
      </div>
    </div>
<div class="content">
<div class="line">
<div class="content mainContent">
<div class="sidebar"><div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">marked.js Example File</h1>
<span class="subtitle">webengine/recipebrowser/resources/pages/assets/3rdparty/marked.js</span>
<!-- $$$webengine/recipebrowser/resources/pages/assets/3rdparty/marked.js-description -->
<div class="descr"> <a name="details"></a>
<pre class="js">

  <span class="comment">/**
   * marked - a markdown parser
   * Copyright (c) 2011-2014, Christopher Jeffrey. (MIT Licensed)
   * https://github.com/chjj/marked
   */</span>

  ;(<span class="keyword">function</span>() {

  <span class="comment">/**
   * Block-Level Grammar
   */</span>

  var <span class="name">block</span> = {
    newline: /^\n+/,
    code: /^( {4}[^\n]+\n*)+/,
    fences: <span class="name">noop</span>,
    hr: /^( *[-*_]){3,} *(?:\n+|$)/,
    heading: /^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,
    nptable: <span class="name">noop</span>,
    lheading: /^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,
    blockquote: /^( *&gt;[^\n]+(\n(?!def)[^\n]+)*\n*)+/,
    list: /^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,
    html: /^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,
    def: /^ *\[([^\]]+)\]: *&lt;?([^\s&gt;]+)&gt;?(?: +[&quot;(]([^\n]+)[&quot;)])? *(?:\n+|$)/,
    table: <span class="name">noop</span>,
    paragraph: /^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,
    text: /^[^\n]+/
  };

  <span class="name">block</span>.<span class="name">bullet</span> <span class="operator">=</span> /(?:[*+-]|\d+\.)/;
  <span class="name">block</span>.<span class="name">item</span> <span class="operator">=</span> /^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/;
  <span class="name">block</span>.<span class="name">item</span> <span class="operator">=</span> <span class="name">replace</span>(<span class="name">block</span>.<span class="name">item</span>, <span class="string">'gm'</span>)
    (/bull/g, <span class="name">block</span>.<span class="name">bullet</span>)
    ();

  <span class="name">block</span>.<span class="name">list</span> <span class="operator">=</span> <span class="name">replace</span>(<span class="name">block</span>.<span class="name">list</span>)
    (/bull/g, <span class="name">block</span>.<span class="name">bullet</span>)
    (<span class="string">'hr'</span>, <span class="string">'\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))'</span>)
    (<span class="string">'def'</span>, <span class="string">'\\n+(?='</span> <span class="operator">+</span> <span class="name">block</span>.<span class="name">def</span>.<span class="name">source</span> <span class="operator">+</span> <span class="string">')'</span>)
    ();

  <span class="name">block</span>.<span class="name">blockquote</span> <span class="operator">=</span> <span class="name">replace</span>(<span class="name">block</span>.<span class="name">blockquote</span>)
    (<span class="string">'def'</span>, <span class="name">block</span>.<span class="name">def</span>)
    ();

  <span class="name">block</span>.<span class="name">_tag</span> <span class="operator">=</span> <span class="string">'(?!(?:'</span>
    <span class="operator">+</span> <span class="string">'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code'</span>
    <span class="operator">+</span> <span class="string">'|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo'</span>
    <span class="operator">+</span> <span class="string">'|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b'</span>;

  <span class="name">block</span>.<span class="name">html</span> <span class="operator">=</span> <span class="name">replace</span>(<span class="name">block</span>.<span class="name">html</span>)
    (<span class="string">'comment'</span>, /&lt;!--[\s\S]*?--&gt;/)
    (<span class="string">'closed'</span>, /&lt;(tag)[\s\S]+?&lt;\/\1&gt;/)
    (<span class="string">'closing'</span>, /&lt;tag(?:&quot;[^&quot;]*&quot;|'[^']*'|[^'&quot;&gt;])*?&gt;/)
    (/tag/g, <span class="name">block</span>.<span class="name">_tag</span>)
    ();

  <span class="name">block</span>.<span class="name">paragraph</span> <span class="operator">=</span> <span class="name">replace</span>(<span class="name">block</span>.<span class="name">paragraph</span>)
    (<span class="string">'hr'</span>, <span class="name">block</span>.<span class="name">hr</span>)
    (<span class="string">'heading'</span>, <span class="name">block</span>.<span class="name">heading</span>)
    (<span class="string">'lheading'</span>, <span class="name">block</span>.<span class="name">lheading</span>)
    (<span class="string">'blockquote'</span>, <span class="name">block</span>.<span class="name">blockquote</span>)
    (<span class="string">'tag'</span>, <span class="string">'&lt;'</span> <span class="operator">+</span> <span class="name">block</span>.<span class="name">_tag</span>)
    (<span class="string">'def'</span>, <span class="name">block</span>.<span class="name">def</span>)
    ();

  <span class="comment">/**
   * Normal Block Grammar
   */</span>

  <span class="name">block</span>.<span class="name">normal</span> <span class="operator">=</span> <span class="name">merge</span>({}, <span class="name">block</span>);

  <span class="comment">/**
   * GFM Block Grammar
   */</span>

  <span class="name">block</span>.<span class="name">gfm</span> <span class="operator">=</span> <span class="name">merge</span>({}, <span class="name">block</span>.<span class="name">normal</span>, {
    fences: /^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,
    paragraph: /^/,
    heading: /^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/
  });

  <span class="name">block</span>.<span class="name">gfm</span>.<span class="name">paragraph</span> <span class="operator">=</span> <span class="name">replace</span>(<span class="name">block</span>.<span class="name">paragraph</span>)
    (<span class="string">'(?!'</span>, <span class="string">'(?!'</span>
      <span class="operator">+</span> <span class="name">block</span>.<span class="name">gfm</span>.<span class="name">fences</span>.<span class="name">source</span>.<span class="name">replace</span>(<span class="string">'\\1'</span>, <span class="string">'\\2'</span>) <span class="operator">+</span> <span class="string">'|'</span>
      <span class="operator">+</span> <span class="name">block</span>.<span class="name">list</span>.<span class="name">source</span>.<span class="name">replace</span>(<span class="string">'\\1'</span>, <span class="string">'\\3'</span>) <span class="operator">+</span> <span class="string">'|'</span>)
    ();

  <span class="comment">/**
   * GFM + Tables Block Grammar
   */</span>

  <span class="name">block</span>.<span class="name">tables</span> <span class="operator">=</span> <span class="name">merge</span>({}, <span class="name">block</span>.<span class="name">gfm</span>, {
    nptable: /^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,
    table: /^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/
  });

  <span class="comment">/**
   * Block Lexer
   */</span>

  <span class="keyword">function</span> <span class="name">Lexer</span>(<span class="name">options</span>) {
    this.<span class="name">tokens</span> <span class="operator">=</span> [];
    this.<span class="name">tokens</span>.<span class="name">links</span> <span class="operator">=</span> {};
    this.<span class="name">options</span> <span class="operator">=</span> <span class="name">options</span> <span class="operator">||</span> <span class="name">marked</span>.<span class="name">defaults</span>;
    this.<span class="name">rules</span> <span class="operator">=</span> <span class="name">block</span>.<span class="name">normal</span>;

    <span class="keyword">if</span> (this.<span class="name">options</span>.<span class="name">gfm</span>) {
      <span class="keyword">if</span> (this.<span class="name">options</span>.<span class="name">tables</span>) {
        this.<span class="name">rules</span> <span class="operator">=</span> <span class="name">block</span>.<span class="name">tables</span>;
      } <span class="keyword">else</span> {
        this.<span class="name">rules</span> <span class="operator">=</span> <span class="name">block</span>.<span class="name">gfm</span>;
      }
    }
  }

  <span class="comment">/**
   * Expose Block Rules
   */</span>

  <span class="name">Lexer</span>.<span class="name">rules</span> <span class="operator">=</span> <span class="name">block</span>;

  <span class="comment">/**
   * Static Lex Method
   */</span>

  <span class="name">Lexer</span>.<span class="name">lex</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">src</span>, options) {
    var <span class="name">lexer</span> = new <span class="name">Lexer</span>(<span class="name">options</span>);
    <span class="keyword">return</span> <span class="name">lexer</span>.<span class="name">lex</span>(<span class="name">src</span>);
  };

  <span class="comment">/**
   * Preprocessing
   */</span>

  <span class="name">Lexer</span>.<span class="name">prototype</span>.<span class="name">lex</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">src</span>) {
    <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>
      .<span class="name">replace</span>(/\r\n|\r/g, <span class="string">'\n'</span>)
      .<span class="name">replace</span>(/\t/g, <span class="string">'    '</span>)
      .<span class="name">replace</span>(/\u00a0/g, <span class="string">' '</span>)
      .<span class="name">replace</span>(/\u2424/g, <span class="string">'\n'</span>);

    <span class="keyword">return</span> this.<span class="name">token</span>(<span class="name">src</span>, <span class="number">true</span>);
  };

  <span class="comment">/**
   * Lexing
   */</span>

  <span class="name">Lexer</span>.<span class="name">prototype</span>.<span class="name">token</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">src</span>, top, bq) {
    var <span class="name">src</span> = <span class="name">src</span>.<span class="name">replace</span>(/^ +$/gm, <span class="string">''</span>)
      , <span class="name">next</span>
      , <span class="name">loose</span>
      , <span class="name">cap</span>
      , <span class="name">bull</span>
      , <span class="name">b</span>
      , <span class="name">item</span>
      , <span class="name">space</span>
      , <span class="name">i</span>
      , <span class="name">l</span>;

    <span class="keyword">while</span> (<span class="name">src</span>) {
      <span class="comment">// newline</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">newline</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="keyword">if</span> (<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span> <span class="operator">&gt;</span> <span class="number">1</span>) {
          this.<span class="name">tokens</span>.<span class="name">push</span>({
            type: <span class="string">'space'</span>
          });
        }
      }

      <span class="comment">// code</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">code</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="name">cap</span> <span class="operator">=</span> <span class="name">cap</span>[<span class="number">0</span>].<span class="name">replace</span>(/^ {4}/gm, <span class="string">''</span>);
        this.<span class="name">tokens</span>.<span class="name">push</span>({
          type: <span class="string">'code'</span>,
          text: !this.<span class="name">options</span>.<span class="name">pedantic</span>
            ? <span class="name">cap</span>.<span class="name">replace</span>(/\n+$/, <span class="string">''</span>)
            : <span class="name">cap</span>
        });
        <span class="keyword">continue</span>;
      }

      <span class="comment">// fences (gfm)</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">fences</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        this.<span class="name">tokens</span>.<span class="name">push</span>({
          type: <span class="string">'code'</span>,
          lang: <span class="name">cap</span>[<span class="number">2</span>],
          text: <span class="name">cap</span>[<span class="number">3</span>] <span class="operator">||</span> <span class="string">''</span>
        });
        <span class="keyword">continue</span>;
      }

      <span class="comment">// heading</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">heading</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        this.<span class="name">tokens</span>.<span class="name">push</span>({
          type: <span class="string">'heading'</span>,
          depth: <span class="name">cap</span>[<span class="number">1</span>].<span class="name">length</span>,
          text: <span class="name">cap</span>[<span class="number">2</span>]
        });
        <span class="keyword">continue</span>;
      }

      <span class="comment">// table no leading pipe (gfm)</span>
      <span class="keyword">if</span> (<span class="name">top</span> <span class="operator">&amp;&amp;</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">nptable</span>.<span class="name">exec</span>(<span class="name">src</span>))) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);

        <span class="name">item</span> <span class="operator">=</span> {
          type: <span class="string">'table'</span>,
          header: <span class="name">cap</span>[<span class="number">1</span>].<span class="name">replace</span>(/^ *| *\| *$/g, <span class="string">''</span>).<span class="name">split</span>(/ *\| */),
          align: <span class="name">cap</span>[<span class="number">2</span>].<span class="name">replace</span>(/^ *|\| *$/g, <span class="string">''</span>).<span class="name">split</span>(/ *\| */),
          cells: <span class="name">cap</span>[<span class="number">3</span>].<span class="name">replace</span>(/\n$/, <span class="string">''</span>).<span class="name">split</span>(<span class="string">'\n'</span>)
        };

        <span class="keyword">for</span> (<span class="name">i</span> <span class="operator">=</span> <span class="number">0</span>; <span class="name">i</span> <span class="operator">&lt;</span> <span class="name">item</span>.<span class="name">align</span>.<span class="name">length</span>; i++) {
          <span class="keyword">if</span> (/^ *-+: *$/.<span class="name">test</span>(<span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>])) {
            <span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>] <span class="operator">=</span> <span class="string">'right'</span>;
          } <span class="keyword">else</span> <span class="keyword">if</span> (/^ *:-+: *$/.<span class="name">test</span>(<span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>])) {
            <span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>] <span class="operator">=</span> <span class="string">'center'</span>;
          } <span class="keyword">else</span> <span class="keyword">if</span> (/^ *:-+ *$/.<span class="name">test</span>(<span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>])) {
            <span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>] <span class="operator">=</span> <span class="string">'left'</span>;
          } <span class="keyword">else</span> {
            <span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>] <span class="operator">=</span> <span class="number">null</span>;
          }
        }

        <span class="keyword">for</span> (<span class="name">i</span> <span class="operator">=</span> <span class="number">0</span>; <span class="name">i</span> <span class="operator">&lt;</span> <span class="name">item</span>.<span class="name">cells</span>.<span class="name">length</span>; i++) {
          <span class="name">item</span>.<span class="name">cells</span>[<span class="name">i</span>] <span class="operator">=</span> <span class="name">item</span>.<span class="name">cells</span>[<span class="name">i</span>].<span class="name">split</span>(/ *\| */);
        }

        this.<span class="name">tokens</span>.<span class="name">push</span>(<span class="name">item</span>);

        <span class="keyword">continue</span>;
      }

      <span class="comment">// lheading</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">lheading</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        this.<span class="name">tokens</span>.<span class="name">push</span>({
          type: <span class="string">'heading'</span>,
          depth: <span class="name">cap</span>[<span class="number">2</span>] <span class="operator">===</span> <span class="string">'='</span> ? <span class="number">1</span> : <span class="number">2</span>,
          text: <span class="name">cap</span>[<span class="number">1</span>]
        });
        <span class="keyword">continue</span>;
      }

      <span class="comment">// hr</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">hr</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        this.<span class="name">tokens</span>.<span class="name">push</span>({
          type: <span class="string">'hr'</span>
        });
        <span class="keyword">continue</span>;
      }

      <span class="comment">// blockquote</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">blockquote</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);

        this.<span class="name">tokens</span>.<span class="name">push</span>({
          type: <span class="string">'blockquote_start'</span>
        });

        <span class="name">cap</span> <span class="operator">=</span> <span class="name">cap</span>[<span class="number">0</span>].<span class="name">replace</span>(/^ *&gt; ?/gm, <span class="string">''</span>);

        <span class="comment">// Pass `top` to keep the current</span>
        <span class="comment">// &quot;toplevel&quot; state. This is exactly</span>
        <span class="comment">// how markdown.pl works.</span>
        this.<span class="name">token</span>(<span class="name">cap</span>, <span class="name">top</span>, <span class="number">true</span>);

        this.<span class="name">tokens</span>.<span class="name">push</span>({
          type: <span class="string">'blockquote_end'</span>
        });

        <span class="keyword">continue</span>;
      }

      <span class="comment">// list</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">list</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="name">bull</span> <span class="operator">=</span> <span class="name">cap</span>[<span class="number">2</span>];

        this.<span class="name">tokens</span>.<span class="name">push</span>({
          type: <span class="string">'list_start'</span>,
          ordered: <span class="name">bull</span>.<span class="name">length</span> <span class="operator">&gt;</span> <span class="number">1</span>
        });

        <span class="comment">// Get each top-level item.</span>
        <span class="name">cap</span> <span class="operator">=</span> <span class="name">cap</span>[<span class="number">0</span>].<span class="name">match</span>(this.<span class="name">rules</span>.<span class="name">item</span>);

        <span class="name">next</span> <span class="operator">=</span> <span class="number">false</span>;
        <span class="name">l</span> <span class="operator">=</span> <span class="name">cap</span>.<span class="name">length</span>;
        <span class="name">i</span> <span class="operator">=</span> <span class="number">0</span>;

        <span class="keyword">for</span> (; <span class="name">i</span> <span class="operator">&lt;</span> <span class="name">l</span>; i++) {
          <span class="name">item</span> <span class="operator">=</span> <span class="name">cap</span>[<span class="name">i</span>];

          <span class="comment">// Remove the list item's bullet</span>
          <span class="comment">// so it is seen as the next token.</span>
          <span class="name">space</span> <span class="operator">=</span> <span class="name">item</span>.<span class="name">length</span>;
          <span class="name">item</span> <span class="operator">=</span> <span class="name">item</span>.<span class="name">replace</span>(/^ *([*+-]|\d+\.) +/, <span class="string">''</span>);

          <span class="comment">// Outdent whatever the</span>
          <span class="comment">// list item contains. Hacky.</span>
          <span class="keyword">if</span> (~<span class="name">item</span>.<span class="name">indexOf</span>(<span class="string">'\n '</span>)) {
            <span class="name">space</span> <span class="operator">-=</span> <span class="name">item</span>.<span class="name">length</span>;
            <span class="name">item</span> <span class="operator">=</span> !this.<span class="name">options</span>.<span class="name">pedantic</span>
              ? <span class="name">item</span>.<span class="name">replace</span>(new <span class="name">RegExp</span>(<span class="string">'^ {1,'</span> <span class="operator">+</span> <span class="name">space</span> <span class="operator">+</span> <span class="string">'}'</span>, <span class="string">'gm'</span>), <span class="string">''</span>)
              : <span class="name">item</span>.<span class="name">replace</span>(/^ {1,4}/gm, <span class="string">''</span>);
          }

          <span class="comment">// Determine whether the next list item belongs here.</span>
          <span class="comment">// Backpedal if it does not belong in this list.</span>
          <span class="keyword">if</span> (this.<span class="name">options</span>.<span class="name">smartLists</span> <span class="operator">&amp;&amp;</span> <span class="name">i</span> <span class="operator">!==</span> <span class="name">l</span> <span class="operator">-</span> <span class="number">1</span>) {
            <span class="name">b</span> <span class="operator">=</span> <span class="name">block</span>.<span class="name">bullet</span>.<span class="name">exec</span>(<span class="name">cap</span>[<span class="name">i</span> <span class="operator">+</span> <span class="number">1</span>])[<span class="number">0</span>];
            <span class="keyword">if</span> (<span class="name">bull</span> <span class="operator">!==</span> <span class="name">b</span> <span class="operator">&amp;&amp;</span> !(<span class="name">bull</span>.<span class="name">length</span> <span class="operator">&gt;</span> <span class="number">1</span> <span class="operator">&amp;&amp;</span> <span class="name">b</span>.<span class="name">length</span> <span class="operator">&gt;</span> <span class="number">1</span>)) {
              <span class="name">src</span> <span class="operator">=</span> <span class="name">cap</span>.<span class="name">slice</span>(<span class="name">i</span> <span class="operator">+</span> <span class="number">1</span>).<span class="name">join</span>(<span class="string">'\n'</span>) <span class="operator">+</span> <span class="name">src</span>;
              <span class="name">i</span> <span class="operator">=</span> <span class="name">l</span> <span class="operator">-</span> <span class="number">1</span>;
            }
          }

          <span class="comment">// Determine whether item is loose or not.</span>
          <span class="comment">// Use: /(^|\n)(?! )[^\n]+\n\n(?!\s*$)/</span>
          <span class="comment">// for discount behavior.</span>
          <span class="name">loose</span> <span class="operator">=</span> <span class="name">next</span> <span class="operator">||</span> /\n\n(?!\s*$)/.<span class="name">test</span>(<span class="name">item</span>);
          <span class="keyword">if</span> (<span class="name">i</span> <span class="operator">!==</span> <span class="name">l</span> <span class="operator">-</span> <span class="number">1</span>) {
            <span class="name">next</span> <span class="operator">=</span> <span class="name">item</span>.<span class="name">charAt</span>(<span class="name">item</span>.<span class="name">length</span> <span class="operator">-</span> <span class="number">1</span>) <span class="operator">===</span> <span class="string">'\n'</span>;
            <span class="keyword">if</span> (!<span class="name">loose</span>) <span class="name">loose</span> <span class="operator">=</span> <span class="name">next</span>;
          }

          this.<span class="name">tokens</span>.<span class="name">push</span>({
            type: <span class="name">loose</span>
              ? <span class="string">'loose_item_start'</span>
              : <span class="string">'list_item_start'</span>
          });

          <span class="comment">// Recurse.</span>
          this.<span class="name">token</span>(<span class="name">item</span>, <span class="number">false</span>, <span class="name">bq</span>);

          this.<span class="name">tokens</span>.<span class="name">push</span>({
            type: <span class="string">'list_item_end'</span>
          });
        }

        this.<span class="name">tokens</span>.<span class="name">push</span>({
          type: <span class="string">'list_end'</span>
        });

        <span class="keyword">continue</span>;
      }

      <span class="comment">// html</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">html</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        this.<span class="name">tokens</span>.<span class="name">push</span>({
          type: this.<span class="name">options</span>.<span class="name">sanitize</span>
            ? <span class="string">'paragraph'</span>
            : <span class="string">'html'</span>,
          pre: !this.<span class="name">options</span>.<span class="name">sanitizer</span>
            <span class="operator">&amp;&amp;</span> (<span class="name">cap</span>[<span class="number">1</span>] <span class="operator">===</span> <span class="string">'pre'</span> <span class="operator">||</span> <span class="name">cap</span>[<span class="number">1</span>] <span class="operator">===</span> <span class="string">'script'</span> <span class="operator">||</span> <span class="name">cap</span>[<span class="number">1</span>] <span class="operator">===</span> <span class="string">'style'</span>),
          text: <span class="name">cap</span>[<span class="number">0</span>]
        });
        <span class="keyword">continue</span>;
      }

      <span class="comment">// def</span>
      <span class="keyword">if</span> ((!<span class="name">bq</span> <span class="operator">&amp;&amp;</span> <span class="name">top</span>) <span class="operator">&amp;&amp;</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">def</span>.<span class="name">exec</span>(<span class="name">src</span>))) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        this.<span class="name">tokens</span>.<span class="name">links</span>[<span class="name">cap</span>[<span class="number">1</span>].<span class="name">toLowerCase</span>()] <span class="operator">=</span> {
          href: <span class="name">cap</span>[<span class="number">2</span>],
          title: <span class="name">cap</span>[<span class="number">3</span>]
        };
        <span class="keyword">continue</span>;
      }

      <span class="comment">// table (gfm)</span>
      <span class="keyword">if</span> (<span class="name">top</span> <span class="operator">&amp;&amp;</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">table</span>.<span class="name">exec</span>(<span class="name">src</span>))) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);

        <span class="name">item</span> <span class="operator">=</span> {
          type: <span class="string">'table'</span>,
          header: <span class="name">cap</span>[<span class="number">1</span>].<span class="name">replace</span>(/^ *| *\| *$/g, <span class="string">''</span>).<span class="name">split</span>(/ *\| */),
          align: <span class="name">cap</span>[<span class="number">2</span>].<span class="name">replace</span>(/^ *|\| *$/g, <span class="string">''</span>).<span class="name">split</span>(/ *\| */),
          cells: <span class="name">cap</span>[<span class="number">3</span>].<span class="name">replace</span>(/(?: *\| *)?\n$/, <span class="string">''</span>).<span class="name">split</span>(<span class="string">'\n'</span>)
        };

        <span class="keyword">for</span> (<span class="name">i</span> <span class="operator">=</span> <span class="number">0</span>; <span class="name">i</span> <span class="operator">&lt;</span> <span class="name">item</span>.<span class="name">align</span>.<span class="name">length</span>; i++) {
          <span class="keyword">if</span> (/^ *-+: *$/.<span class="name">test</span>(<span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>])) {
            <span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>] <span class="operator">=</span> <span class="string">'right'</span>;
          } <span class="keyword">else</span> <span class="keyword">if</span> (/^ *:-+: *$/.<span class="name">test</span>(<span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>])) {
            <span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>] <span class="operator">=</span> <span class="string">'center'</span>;
          } <span class="keyword">else</span> <span class="keyword">if</span> (/^ *:-+ *$/.<span class="name">test</span>(<span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>])) {
            <span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>] <span class="operator">=</span> <span class="string">'left'</span>;
          } <span class="keyword">else</span> {
            <span class="name">item</span>.<span class="name">align</span>[<span class="name">i</span>] <span class="operator">=</span> <span class="number">null</span>;
          }
        }

        <span class="keyword">for</span> (<span class="name">i</span> <span class="operator">=</span> <span class="number">0</span>; <span class="name">i</span> <span class="operator">&lt;</span> <span class="name">item</span>.<span class="name">cells</span>.<span class="name">length</span>; i++) {
          <span class="name">item</span>.<span class="name">cells</span>[<span class="name">i</span>] <span class="operator">=</span> <span class="name">item</span>.<span class="name">cells</span>[<span class="name">i</span>]
            .<span class="name">replace</span>(/^ *\| *| *\| *$/g, <span class="string">''</span>)
            .<span class="name">split</span>(/ *\| */);
        }

        this.<span class="name">tokens</span>.<span class="name">push</span>(<span class="name">item</span>);

        <span class="keyword">continue</span>;
      }

      <span class="comment">// top-level paragraph</span>
      <span class="keyword">if</span> (<span class="name">top</span> <span class="operator">&amp;&amp;</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">paragraph</span>.<span class="name">exec</span>(<span class="name">src</span>))) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        this.<span class="name">tokens</span>.<span class="name">push</span>({
          type: <span class="string">'paragraph'</span>,
          text: <span class="name">cap</span>[<span class="number">1</span>].<span class="name">charAt</span>(<span class="name">cap</span>[<span class="number">1</span>].<span class="name">length</span> <span class="operator">-</span> <span class="number">1</span>) <span class="operator">===</span> <span class="string">'\n'</span>
            ? <span class="name">cap</span>[<span class="number">1</span>].<span class="name">slice</span>(<span class="number">0</span>, -<span class="number">1</span>)
            : <span class="name">cap</span>[<span class="number">1</span>]
        });
        <span class="keyword">continue</span>;
      }

      <span class="comment">// text</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">text</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="comment">// Top-level should never reach here.</span>
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        this.<span class="name">tokens</span>.<span class="name">push</span>({
          type: <span class="string">'text'</span>,
          text: <span class="name">cap</span>[<span class="number">0</span>]
        });
        <span class="keyword">continue</span>;
      }

      <span class="keyword">if</span> (<span class="name">src</span>) {
        <span class="keyword">throw</span> new
          <span class="name">Error</span>(<span class="string">'Infinite loop on byte: '</span> <span class="operator">+</span> <span class="name">src</span>.<span class="name">charCodeAt</span>(<span class="number">0</span>));
      }
    }

    <span class="keyword">return</span> this.<span class="name">tokens</span>;
  };

  <span class="comment">/**
   * Inline-Level Grammar
   */</span>

  var <span class="name">inline</span> = {
    escape: /^\\([\\`*{}\[\]()#+\-.!_&gt;])/,
    autolink: /^&lt;([^ &gt;]+(@|:\/)[^ &gt;]+)&gt;/,
    url: <span class="name">noop</span>,
    tag: /^&lt;!--[\s\S]*?--&gt;|^&lt;\/?\w+(?:&quot;[^&quot;]*&quot;|'[^']*'|[^'&quot;&gt;])*?&gt;/,
    link: /^!?\[(inside)\]\(href\)/,
    reflink: /^!?\[(inside)\]\s*\[([^\]]*)\]/,
    nolink: /^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,
    strong: /^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,
    em: /^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,
    code: /^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,
    br: /^ {2,}\n(?!\s*$)/,
    del: <span class="name">noop</span>,
    text: /^[\s\S]+?(?=[\\&lt;!\[_*`]| {2,}\n|$)/
  };

  <span class="name">inline</span>.<span class="name">_inside</span> <span class="operator">=</span> /(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/;
  <span class="name">inline</span>.<span class="name">_href</span> <span class="operator">=</span> /\s*&lt;?([\s\S]*?)&gt;?(?:\s+['&quot;]([\s\S]*?)['&quot;])?\s*/;

  <span class="name">inline</span>.<span class="name">link</span> <span class="operator">=</span> <span class="name">replace</span>(<span class="name">inline</span>.<span class="name">link</span>)
    (<span class="string">'inside'</span>, <span class="name">inline</span>.<span class="name">_inside</span>)
    (<span class="string">'href'</span>, <span class="name">inline</span>.<span class="name">_href</span>)
    ();

  <span class="name">inline</span>.<span class="name">reflink</span> <span class="operator">=</span> <span class="name">replace</span>(<span class="name">inline</span>.<span class="name">reflink</span>)
    (<span class="string">'inside'</span>, <span class="name">inline</span>.<span class="name">_inside</span>)
    ();

  <span class="comment">/**
   * Normal Inline Grammar
   */</span>

  <span class="name">inline</span>.<span class="name">normal</span> <span class="operator">=</span> <span class="name">merge</span>({}, <span class="name">inline</span>);

  <span class="comment">/**
   * Pedantic Inline Grammar
   */</span>

  <span class="name">inline</span>.<span class="name">pedantic</span> <span class="operator">=</span> <span class="name">merge</span>({}, <span class="name">inline</span>.<span class="name">normal</span>, {
    strong: /^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,
    em: /^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/
  });

  <span class="comment">/**
   * GFM Inline Grammar
   */</span>

  <span class="name">inline</span>.<span class="name">gfm</span> <span class="operator">=</span> <span class="name">merge</span>({}, <span class="name">inline</span>.<span class="name">normal</span>, {
    escape: <span class="name">replace</span>(<span class="name">inline</span>.<span class="name">escape</span>)(<span class="string">'])'</span>, <span class="string">'~|])'</span>)(),
    url: /^(https?:\/\/[^\s&lt;]+[^&lt;.,:;&quot;')\]\s])/,
    del: /^~~(?=\S)([\s\S]*?\S)~~/,
    text: <span class="name">replace</span>(<span class="name">inline</span>.<span class="name">text</span>)
      (<span class="string">']|'</span>, <span class="string">'~]|'</span>)
      (<span class="string">'|'</span>, <span class="string">'|https?://|'</span>)
      ()
  });

  <span class="comment">/**
   * GFM + Line Breaks Inline Grammar
   */</span>

  <span class="name">inline</span>.<span class="name">breaks</span> <span class="operator">=</span> <span class="name">merge</span>({}, <span class="name">inline</span>.<span class="name">gfm</span>, {
    br: <span class="name">replace</span>(<span class="name">inline</span>.<span class="name">br</span>)(<span class="string">'{2,}'</span>, <span class="string">'*'</span>)(),
    text: <span class="name">replace</span>(<span class="name">inline</span>.<span class="name">gfm</span>.<span class="name">text</span>)(<span class="string">'{2,}'</span>, <span class="string">'*'</span>)()
  });

  <span class="comment">/**
   * Inline Lexer &amp; Compiler
   */</span>

  <span class="keyword">function</span> <span class="name">InlineLexer</span>(<span class="name">links</span>, options) {
    this.<span class="name">options</span> <span class="operator">=</span> <span class="name">options</span> <span class="operator">||</span> <span class="name">marked</span>.<span class="name">defaults</span>;
    this.<span class="name">links</span> <span class="operator">=</span> <span class="name">links</span>;
    this.<span class="name">rules</span> <span class="operator">=</span> <span class="name">inline</span>.<span class="name">normal</span>;
    this.<span class="name">renderer</span> <span class="operator">=</span> this.<span class="name">options</span>.<span class="name">renderer</span> <span class="operator">||</span> new <span class="name">Renderer</span>;
    this.<span class="name">renderer</span>.<span class="name">options</span> <span class="operator">=</span> this.<span class="name">options</span>;

    <span class="keyword">if</span> (!this.<span class="name">links</span>) {
      <span class="keyword">throw</span> new
        <span class="name">Error</span>(<span class="string">'Tokens array requires a `links` property.'</span>);
    }

    <span class="keyword">if</span> (this.<span class="name">options</span>.<span class="name">gfm</span>) {
      <span class="keyword">if</span> (this.<span class="name">options</span>.<span class="name">breaks</span>) {
        this.<span class="name">rules</span> <span class="operator">=</span> <span class="name">inline</span>.<span class="name">breaks</span>;
      } <span class="keyword">else</span> {
        this.<span class="name">rules</span> <span class="operator">=</span> <span class="name">inline</span>.<span class="name">gfm</span>;
      }
    } <span class="keyword">else</span> <span class="keyword">if</span> (this.<span class="name">options</span>.<span class="name">pedantic</span>) {
      this.<span class="name">rules</span> <span class="operator">=</span> <span class="name">inline</span>.<span class="name">pedantic</span>;
    }
  }

  <span class="comment">/**
   * Expose Inline Rules
   */</span>

  <span class="name">InlineLexer</span>.<span class="name">rules</span> <span class="operator">=</span> <span class="name">inline</span>;

  <span class="comment">/**
   * Static Lexing/Compiling Method
   */</span>

  <span class="name">InlineLexer</span>.<span class="name">output</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">src</span>, links, options) {
    var <span class="name">inline</span> = new <span class="name">InlineLexer</span>(<span class="name">links</span>, <span class="name">options</span>);
    <span class="keyword">return</span> <span class="name">inline</span>.<span class="name">output</span>(<span class="name">src</span>);
  };

  <span class="comment">/**
   * Lexing/Compiling
   */</span>

  <span class="name">InlineLexer</span>.<span class="name">prototype</span>.<span class="name">output</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">src</span>) {
    var <span class="name">out</span> = <span class="string">''</span>
      , <span class="name">link</span>
      , <span class="name">text</span>
      , <span class="name">href</span>
      , <span class="name">cap</span>;

    <span class="keyword">while</span> (<span class="name">src</span>) {
      <span class="comment">// escape</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">escape</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="name">out</span> <span class="operator">+=</span> <span class="name">cap</span>[<span class="number">1</span>];
        <span class="keyword">continue</span>;
      }

      <span class="comment">// autolink</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">autolink</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="keyword">if</span> (<span class="name">cap</span>[<span class="number">2</span>] <span class="operator">===</span> <span class="string">'@'</span>) {
          <span class="name">text</span> <span class="operator">=</span> <span class="name">cap</span>[<span class="number">1</span>].<span class="name">charAt</span>(<span class="number">6</span>) <span class="operator">===</span> <span class="string">':'</span>
            ? this.<span class="name">mangle</span>(<span class="name">cap</span>[<span class="number">1</span>].<span class="name">substring</span>(<span class="number">7</span>))
            : this.<span class="name">mangle</span>(<span class="name">cap</span>[<span class="number">1</span>]);
          <span class="name">href</span> <span class="operator">=</span> this.<span class="name">mangle</span>(<span class="string">'mailto:'</span>) <span class="operator">+</span> <span class="name">text</span>;
        } <span class="keyword">else</span> {
          <span class="name">text</span> <span class="operator">=</span> <span class="name">escape</span>(<span class="name">cap</span>[<span class="number">1</span>]);
          <span class="name">href</span> <span class="operator">=</span> <span class="name">text</span>;
        }
        <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">renderer</span>.<span class="name">link</span>(<span class="name">href</span>, <span class="number">null</span>, <span class="name">text</span>);
        <span class="keyword">continue</span>;
      }

      <span class="comment">// url (gfm)</span>
      <span class="keyword">if</span> (!this.<span class="name">inLink</span> <span class="operator">&amp;&amp;</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">url</span>.<span class="name">exec</span>(<span class="name">src</span>))) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="name">text</span> <span class="operator">=</span> <span class="name">escape</span>(<span class="name">cap</span>[<span class="number">1</span>]);
        <span class="name">href</span> <span class="operator">=</span> <span class="name">text</span>;
        <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">renderer</span>.<span class="name">link</span>(<span class="name">href</span>, <span class="number">null</span>, <span class="name">text</span>);
        <span class="keyword">continue</span>;
      }

      <span class="comment">// tag</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">tag</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="keyword">if</span> (!this.<span class="name">inLink</span> <span class="operator">&amp;&amp;</span> /^&lt;a /i.<span class="name">test</span>(<span class="name">cap</span>[<span class="number">0</span>])) {
          this.<span class="name">inLink</span> <span class="operator">=</span> <span class="number">true</span>;
        } <span class="keyword">else</span> <span class="keyword">if</span> (this.<span class="name">inLink</span> <span class="operator">&amp;&amp;</span> /^&lt;\/a&gt;/i.<span class="name">test</span>(<span class="name">cap</span>[<span class="number">0</span>])) {
          this.<span class="name">inLink</span> <span class="operator">=</span> <span class="number">false</span>;
        }
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">options</span>.<span class="name">sanitize</span>
          ? this.<span class="name">options</span>.<span class="name">sanitizer</span>
            ? this.<span class="name">options</span>.<span class="name">sanitizer</span>(<span class="name">cap</span>[<span class="number">0</span>])
            : <span class="name">escape</span>(<span class="name">cap</span>[<span class="number">0</span>])
          : <span class="name">cap</span>[<span class="number">0</span>]
        <span class="keyword">continue</span>;
      }

      <span class="comment">// link</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">link</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        this.<span class="name">inLink</span> <span class="operator">=</span> <span class="number">true</span>;
        <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">outputLink</span>(<span class="name">cap</span>, {
          href: <span class="name">cap</span>[<span class="number">2</span>],
          title: <span class="name">cap</span>[<span class="number">3</span>]
        });
        this.<span class="name">inLink</span> <span class="operator">=</span> <span class="number">false</span>;
        <span class="keyword">continue</span>;
      }

      <span class="comment">// reflink, nolink</span>
      <span class="keyword">if</span> ((<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">reflink</span>.<span class="name">exec</span>(<span class="name">src</span>))
          <span class="operator">||</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">nolink</span>.<span class="name">exec</span>(<span class="name">src</span>))) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="name">link</span> <span class="operator">=</span> (<span class="name">cap</span>[<span class="number">2</span>] <span class="operator">||</span> <span class="name">cap</span>[<span class="number">1</span>]).<span class="name">replace</span>(/\s+/g, <span class="string">' '</span>);
        <span class="name">link</span> <span class="operator">=</span> this.<span class="name">links</span>[<span class="name">link</span>.<span class="name">toLowerCase</span>()];
        <span class="keyword">if</span> (!<span class="name">link</span> <span class="operator">||</span> !<span class="name">link</span>.<span class="name">href</span>) {
          <span class="name">out</span> <span class="operator">+=</span> <span class="name">cap</span>[<span class="number">0</span>].<span class="name">charAt</span>(<span class="number">0</span>);
          <span class="name">src</span> <span class="operator">=</span> <span class="name">cap</span>[<span class="number">0</span>].<span class="name">substring</span>(<span class="number">1</span>) <span class="operator">+</span> <span class="name">src</span>;
          <span class="keyword">continue</span>;
        }
        this.<span class="name">inLink</span> <span class="operator">=</span> <span class="number">true</span>;
        <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">outputLink</span>(<span class="name">cap</span>, <span class="name">link</span>);
        this.<span class="name">inLink</span> <span class="operator">=</span> <span class="number">false</span>;
        <span class="keyword">continue</span>;
      }

      <span class="comment">// strong</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">strong</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">renderer</span>.<span class="name">strong</span>(this.<span class="name">output</span>(<span class="name">cap</span>[<span class="number">2</span>] <span class="operator">||</span> <span class="name">cap</span>[<span class="number">1</span>]));
        <span class="keyword">continue</span>;
      }

      <span class="comment">// em</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">em</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">renderer</span>.<span class="name">em</span>(this.<span class="name">output</span>(<span class="name">cap</span>[<span class="number">2</span>] <span class="operator">||</span> <span class="name">cap</span>[<span class="number">1</span>]));
        <span class="keyword">continue</span>;
      }

      <span class="comment">// code</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">code</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">renderer</span>.<span class="name">codespan</span>(<span class="name">escape</span>(<span class="name">cap</span>[<span class="number">2</span>], <span class="number">true</span>));
        <span class="keyword">continue</span>;
      }

      <span class="comment">// br</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">br</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">renderer</span>.<span class="name">br</span>();
        <span class="keyword">continue</span>;
      }

      <span class="comment">// del (gfm)</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">del</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">renderer</span>.<span class="name">del</span>(this.<span class="name">output</span>(<span class="name">cap</span>[<span class="number">1</span>]));
        <span class="keyword">continue</span>;
      }

      <span class="comment">// text</span>
      <span class="keyword">if</span> (<span class="name">cap</span> <span class="operator">=</span> this.<span class="name">rules</span>.<span class="name">text</span>.<span class="name">exec</span>(<span class="name">src</span>)) {
        <span class="name">src</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">substring</span>(<span class="name">cap</span>[<span class="number">0</span>].<span class="name">length</span>);
        <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">renderer</span>.<span class="name">text</span>(<span class="name">escape</span>(this.<span class="name">smartypants</span>(<span class="name">cap</span>[<span class="number">0</span>])));
        <span class="keyword">continue</span>;
      }

      <span class="keyword">if</span> (<span class="name">src</span>) {
        <span class="keyword">throw</span> new
          <span class="name">Error</span>(<span class="string">'Infinite loop on byte: '</span> <span class="operator">+</span> <span class="name">src</span>.<span class="name">charCodeAt</span>(<span class="number">0</span>));
      }
    }

    <span class="keyword">return</span> <span class="name">out</span>;
  };

  <span class="comment">/**
   * Compile Link
   */</span>

  <span class="name">InlineLexer</span>.<span class="name">prototype</span>.<span class="name">outputLink</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">cap</span>, link) {
    var <span class="name">href</span> = <span class="name">escape</span>(<span class="name">link</span>.<span class="name">href</span>)
      , <span class="name">title</span> = <span class="name">link</span>.<span class="name">title</span> ? <span class="name">escape</span>(<span class="name">link</span>.<span class="name">title</span>) : <span class="number">null</span>;

    <span class="keyword">return</span> <span class="name">cap</span>[<span class="number">0</span>].<span class="name">charAt</span>(<span class="number">0</span>) <span class="operator">!==</span> <span class="string">'!'</span>
      ? this.<span class="name">renderer</span>.<span class="name">link</span>(<span class="name">href</span>, <span class="name">title</span>, this.<span class="name">output</span>(<span class="name">cap</span>[<span class="number">1</span>]))
      : this.<span class="name">renderer</span>.<span class="name">image</span>(<span class="name">href</span>, <span class="name">title</span>, <span class="name">escape</span>(<span class="name">cap</span>[<span class="number">1</span>]));
  };

  <span class="comment">/**
   * Smartypants Transformations
   */</span>

  <span class="name">InlineLexer</span>.<span class="name">prototype</span>.<span class="name">smartypants</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">text</span>) {
    <span class="keyword">if</span> (!this.<span class="name">options</span>.<span class="name">smartypants</span>) <span class="keyword">return</span> <span class="name">text</span>;
    <span class="keyword">return</span> <span class="name">text</span>
      <span class="comment">// em-dashes</span>
      .<span class="name">replace</span>(/---/g, <span class="string">'\u2014'</span>)
      <span class="comment">// en-dashes</span>
      .<span class="name">replace</span>(/--/g, <span class="string">'\u2013'</span>)
      <span class="comment">// opening singles</span>
      .<span class="name">replace</span>(/(^|[-\u2014/(\[{&quot;\s])'/g, <span class="string">'$1\u2018'</span>)
      <span class="comment">// closing singles &amp; apostrophes</span>
      .<span class="name">replace</span>(/'/g, <span class="string">'\u2019'</span>)
      <span class="comment">// opening doubles</span>
      .<span class="name">replace</span>(/(^|[-\u2014/(\[{\u2018\s])&quot;/g, <span class="string">'$1\u201c'</span>)
      <span class="comment">// closing doubles</span>
      .<span class="name">replace</span>(/&quot;/g, <span class="string">'\u201d'</span>)
      <span class="comment">// ellipses</span>
      .<span class="name">replace</span>(/\.{3}/g, <span class="string">'\u2026'</span>);
  };

  <span class="comment">/**
   * Mangle Links
   */</span>

  <span class="name">InlineLexer</span>.<span class="name">prototype</span>.<span class="name">mangle</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">text</span>) {
    <span class="keyword">if</span> (!this.<span class="name">options</span>.<span class="name">mangle</span>) <span class="keyword">return</span> <span class="name">text</span>;
    var <span class="name">out</span> = <span class="string">''</span>
      , <span class="name">l</span> = <span class="name">text</span>.<span class="name">length</span>
      , <span class="name">i</span> = <span class="number">0</span>
      , <span class="name">ch</span>;

    <span class="keyword">for</span> (; <span class="name">i</span> <span class="operator">&lt;</span> <span class="name">l</span>; i++) {
      <span class="name">ch</span> <span class="operator">=</span> <span class="name">text</span>.<span class="name">charCodeAt</span>(<span class="name">i</span>);
      <span class="keyword">if</span> (<span class="name">Math</span>.<span class="name">random</span>() <span class="operator">&gt;</span> <span class="number">0.5</span>) {
        <span class="name">ch</span> <span class="operator">=</span> <span class="string">'x'</span> <span class="operator">+</span> <span class="name">ch</span>.<span class="name">toString</span>(<span class="number">16</span>);
      }
      <span class="name">out</span> <span class="operator">+=</span> <span class="string">'&amp;#'</span> <span class="operator">+</span> <span class="name">ch</span> <span class="operator">+</span> <span class="string">';'</span>;
    }

    <span class="keyword">return</span> <span class="name">out</span>;
  };

  <span class="comment">/**
   * Renderer
   */</span>

  <span class="keyword">function</span> <span class="name">Renderer</span>(<span class="name">options</span>) {
    this.<span class="name">options</span> <span class="operator">=</span> <span class="name">options</span> <span class="operator">||</span> {};
  }

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">code</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">code</span>, lang, escaped) {
    <span class="keyword">if</span> (this.<span class="name">options</span>.<span class="name">highlight</span>) {
      var <span class="name">out</span> = this.<span class="name">options</span>.<span class="name">highlight</span>(<span class="name">code</span>, <span class="name">lang</span>);
      <span class="keyword">if</span> (<span class="name">out</span> <span class="operator">!=</span> <span class="number">null</span> <span class="operator">&amp;&amp;</span> <span class="name">out</span> <span class="operator">!==</span> <span class="name">code</span>) {
        <span class="name">escaped</span> <span class="operator">=</span> <span class="number">true</span>;
        <span class="name">code</span> <span class="operator">=</span> <span class="name">out</span>;
      }
    }

    <span class="keyword">if</span> (!<span class="name">lang</span>) {
      <span class="keyword">return</span> <span class="string">'&lt;pre&gt;&lt;code&gt;'</span>
        <span class="operator">+</span> (<span class="name">escaped</span> ? <span class="name">code</span> : <span class="name">escape</span>(<span class="name">code</span>, <span class="number">true</span>))
        <span class="operator">+</span> <span class="string">'\n&lt;/code&gt;&lt;/pre&gt;'</span>;
    }

    <span class="keyword">return</span> <span class="string">'&lt;pre&gt;&lt;code class=&quot;'</span>
      <span class="operator">+</span> this.<span class="name">options</span>.<span class="name">langPrefix</span>
      <span class="operator">+</span> <span class="name">escape</span>(<span class="name">lang</span>, <span class="number">true</span>)
      <span class="operator">+</span> <span class="string">'&quot;&gt;'</span>
      <span class="operator">+</span> (<span class="name">escaped</span> ? <span class="name">code</span> : <span class="name">escape</span>(<span class="name">code</span>, <span class="number">true</span>))
      <span class="operator">+</span> <span class="string">'\n&lt;/code&gt;&lt;/pre&gt;\n'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">blockquote</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">quote</span>) {
    <span class="keyword">return</span> <span class="string">'&lt;blockquote&gt;\n'</span> <span class="operator">+</span> <span class="name">quote</span> <span class="operator">+</span> <span class="string">'&lt;/blockquote&gt;\n'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">html</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">html</span>) {
    <span class="keyword">return</span> <span class="name">html</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">heading</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">text</span>, level, raw) {
    <span class="keyword">return</span> <span class="string">'&lt;h'</span>
      <span class="operator">+</span> <span class="name">level</span>
      <span class="operator">+</span> <span class="string">' id=&quot;'</span>
      <span class="operator">+</span> this.<span class="name">options</span>.<span class="name">headerPrefix</span>
      <span class="operator">+</span> <span class="name">raw</span>.<span class="name">toLowerCase</span>().<span class="name">replace</span>(/[^\w]+/g, <span class="string">'-'</span>)
      <span class="operator">+</span> <span class="string">'&quot;&gt;'</span>
      <span class="operator">+</span> <span class="name">text</span>
      <span class="operator">+</span> <span class="string">'&lt;/h'</span>
      <span class="operator">+</span> <span class="name">level</span>
      <span class="operator">+</span> <span class="string">'&gt;\n'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">hr</span> <span class="operator">=</span> <span class="keyword">function</span>() {
    <span class="keyword">return</span> this.<span class="name">options</span>.<span class="name">xhtml</span> ? <span class="string">'&lt;hr/&gt;\n'</span> : <span class="string">'&lt;hr&gt;\n'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">list</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">body</span>, ordered) {
    var <span class="name">type</span> = <span class="name">ordered</span> ? <span class="string">'ol'</span> : <span class="string">'ul'</span>;
    <span class="keyword">return</span> <span class="string">'&lt;'</span> <span class="operator">+</span> <span class="name">type</span> <span class="operator">+</span> <span class="string">'&gt;\n'</span> <span class="operator">+</span> <span class="name">body</span> <span class="operator">+</span> <span class="string">'&lt;/'</span> <span class="operator">+</span> <span class="name">type</span> <span class="operator">+</span> <span class="string">'&gt;\n'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">listitem</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">text</span>) {
    <span class="keyword">return</span> <span class="string">'&lt;li&gt;'</span> <span class="operator">+</span> <span class="name">text</span> <span class="operator">+</span> <span class="string">'&lt;/li&gt;\n'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">paragraph</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">text</span>) {
    <span class="keyword">return</span> <span class="string">'&lt;p&gt;'</span> <span class="operator">+</span> <span class="name">text</span> <span class="operator">+</span> <span class="string">'&lt;/p&gt;\n'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">table</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">header</span>, body) {
    <span class="keyword">return</span> <span class="string">'&lt;table&gt;\n'</span>
      <span class="operator">+</span> <span class="string">'&lt;thead&gt;\n'</span>
      <span class="operator">+</span> <span class="name">header</span>
      <span class="operator">+</span> <span class="string">'&lt;/thead&gt;\n'</span>
      <span class="operator">+</span> <span class="string">'&lt;tbody&gt;\n'</span>
      <span class="operator">+</span> <span class="name">body</span>
      <span class="operator">+</span> <span class="string">'&lt;/tbody&gt;\n'</span>
      <span class="operator">+</span> <span class="string">'&lt;/table&gt;\n'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">tablerow</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">content</span>) {
    <span class="keyword">return</span> <span class="string">'&lt;tr&gt;\n'</span> <span class="operator">+</span> <span class="name">content</span> <span class="operator">+</span> <span class="string">'&lt;/tr&gt;\n'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">tablecell</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">content</span>, flags) {
    var <span class="name">type</span> = <span class="name">flags</span>.<span class="name">header</span> ? <span class="string">'th'</span> : <span class="string">'td'</span>;
    var <span class="name">tag</span> = <span class="name">flags</span>.<span class="name">align</span>
      ? <span class="string">'&lt;'</span> <span class="operator">+</span> <span class="name">type</span> <span class="operator">+</span> <span class="string">' style=&quot;text-align:'</span> <span class="operator">+</span> <span class="name">flags</span>.<span class="name">align</span> <span class="operator">+</span> <span class="string">'&quot;&gt;'</span>
      : <span class="string">'&lt;'</span> <span class="operator">+</span> <span class="name">type</span> <span class="operator">+</span> <span class="string">'&gt;'</span>;
    <span class="keyword">return</span> <span class="name">tag</span> <span class="operator">+</span> <span class="name">content</span> <span class="operator">+</span> <span class="string">'&lt;/'</span> <span class="operator">+</span> <span class="name">type</span> <span class="operator">+</span> <span class="string">'&gt;\n'</span>;
  };

  <span class="comment">// span level renderer</span>
  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">strong</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">text</span>) {
    <span class="keyword">return</span> <span class="string">'&lt;strong&gt;'</span> <span class="operator">+</span> <span class="name">text</span> <span class="operator">+</span> <span class="string">'&lt;/strong&gt;'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">em</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">text</span>) {
    <span class="keyword">return</span> <span class="string">'&lt;em&gt;'</span> <span class="operator">+</span> <span class="name">text</span> <span class="operator">+</span> <span class="string">'&lt;/em&gt;'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">codespan</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">text</span>) {
    <span class="keyword">return</span> <span class="string">'&lt;code&gt;'</span> <span class="operator">+</span> <span class="name">text</span> <span class="operator">+</span> <span class="string">'&lt;/code&gt;'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">br</span> <span class="operator">=</span> <span class="keyword">function</span>() {
    <span class="keyword">return</span> this.<span class="name">options</span>.<span class="name">xhtml</span> ? <span class="string">'&lt;br/&gt;'</span> : <span class="string">'&lt;br&gt;'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">del</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">text</span>) {
    <span class="keyword">return</span> <span class="string">'&lt;del&gt;'</span> <span class="operator">+</span> <span class="name">text</span> <span class="operator">+</span> <span class="string">'&lt;/del&gt;'</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">link</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">href</span>, title, text) {
    <span class="keyword">if</span> (this.<span class="name">options</span>.<span class="name">sanitize</span>) {
      <span class="keyword">try</span> {
        var <span class="name">prot</span> = <span class="name">decodeURIComponent</span>(<span class="name">unescape</span>(<span class="name">href</span>))
          .<span class="name">replace</span>(/[^\w:]/g, <span class="string">''</span>)
          .<span class="name">toLowerCase</span>();
      } <span class="keyword">catch</span> (<span class="name">e</span>) {
        return '';
      }
      <span class="keyword">if</span> (<span class="name">prot</span>.<span class="name">indexOf</span>(<span class="string">'javascript:'</span>) <span class="operator">===</span> <span class="number">0</span> <span class="operator">||</span> <span class="name">prot</span>.<span class="name">indexOf</span>(<span class="string">'vbscript:'</span>) <span class="operator">===</span> <span class="number">0</span>) {
        <span class="keyword">return</span> <span class="string">''</span>;
      }
    }
    var <span class="name">out</span> = <span class="string">'&lt;a href=&quot;'</span> <span class="operator">+</span> <span class="name">href</span> <span class="operator">+</span> <span class="string">'&quot;'</span>;
    <span class="keyword">if</span> (<span class="name">title</span>) {
      <span class="name">out</span> <span class="operator">+=</span> <span class="string">' title=&quot;'</span> <span class="operator">+</span> <span class="name">title</span> <span class="operator">+</span> <span class="string">'&quot;'</span>;
    }
    <span class="name">out</span> <span class="operator">+=</span> <span class="string">'&gt;'</span> <span class="operator">+</span> <span class="name">text</span> <span class="operator">+</span> <span class="string">'&lt;/a&gt;'</span>;
    <span class="keyword">return</span> <span class="name">out</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">image</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">href</span>, title, text) {
    var <span class="name">out</span> = <span class="string">'&lt;img src=&quot;'</span> <span class="operator">+</span> <span class="name">href</span> <span class="operator">+</span> <span class="string">'&quot; alt=&quot;'</span> <span class="operator">+</span> <span class="name">text</span> <span class="operator">+</span> <span class="string">'&quot;'</span>;
    <span class="keyword">if</span> (<span class="name">title</span>) {
      <span class="name">out</span> <span class="operator">+=</span> <span class="string">' title=&quot;'</span> <span class="operator">+</span> <span class="name">title</span> <span class="operator">+</span> <span class="string">'&quot;'</span>;
    }
    <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">options</span>.<span class="name">xhtml</span> ? <span class="string">'/&gt;'</span> : <span class="string">'&gt;'</span>;
    <span class="keyword">return</span> <span class="name">out</span>;
  };

  <span class="name">Renderer</span>.<span class="name">prototype</span>.<span class="name">text</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">text</span>) {
    <span class="keyword">return</span> <span class="name">text</span>;
  };

  <span class="comment">/**
   * Parsing &amp; Compiling
   */</span>

  <span class="keyword">function</span> <span class="name">Parser</span>(<span class="name">options</span>) {
    this.<span class="name">tokens</span> <span class="operator">=</span> [];
    this.<span class="name">token</span> <span class="operator">=</span> <span class="number">null</span>;
    this.<span class="name">options</span> <span class="operator">=</span> <span class="name">options</span> <span class="operator">||</span> <span class="name">marked</span>.<span class="name">defaults</span>;
    this.<span class="name">options</span>.<span class="name">renderer</span> <span class="operator">=</span> this.<span class="name">options</span>.<span class="name">renderer</span> <span class="operator">||</span> new <span class="name">Renderer</span>;
    this.<span class="name">renderer</span> <span class="operator">=</span> this.<span class="name">options</span>.<span class="name">renderer</span>;
    this.<span class="name">renderer</span>.<span class="name">options</span> <span class="operator">=</span> this.<span class="name">options</span>;
  }

  <span class="comment">/**
   * Static Parse Method
   */</span>

  <span class="name">Parser</span>.<span class="name">parse</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">src</span>, options, renderer) {
    var <span class="name">parser</span> = new <span class="name">Parser</span>(<span class="name">options</span>, <span class="name">renderer</span>);
    <span class="keyword">return</span> <span class="name">parser</span>.<span class="name">parse</span>(<span class="name">src</span>);
  };

  <span class="comment">/**
   * Parse Loop
   */</span>

  <span class="name">Parser</span>.<span class="name">prototype</span>.<span class="name">parse</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">src</span>) {
    this.<span class="name">inline</span> <span class="operator">=</span> new <span class="name">InlineLexer</span>(<span class="name">src</span>.<span class="name">links</span>, this.<span class="name">options</span>, this.<span class="name">renderer</span>);
    this.<span class="name">tokens</span> <span class="operator">=</span> <span class="name">src</span>.<span class="name">reverse</span>();

    var <span class="name">out</span> = <span class="string">''</span>;
    <span class="keyword">while</span> (this.<span class="name">next</span>()) {
      <span class="name">out</span> <span class="operator">+=</span> this.<span class="name">tok</span>();
    }

    <span class="keyword">return</span> <span class="name">out</span>;
  };

  <span class="comment">/**
   * Next Token
   */</span>

  <span class="name">Parser</span>.<span class="name">prototype</span>.<span class="name">next</span> <span class="operator">=</span> <span class="keyword">function</span>() {
    <span class="keyword">return</span> this.<span class="name">token</span> <span class="operator">=</span> this.<span class="name">tokens</span>.<span class="name">pop</span>();
  };

  <span class="comment">/**
   * Preview Next Token
   */</span>

  <span class="name">Parser</span>.<span class="name">prototype</span>.<span class="name">peek</span> <span class="operator">=</span> <span class="keyword">function</span>() {
    <span class="keyword">return</span> this.<span class="name">tokens</span>[this.<span class="name">tokens</span>.<span class="name">length</span> <span class="operator">-</span> <span class="number">1</span>] <span class="operator">||</span> <span class="number">0</span>;
  };

  <span class="comment">/**
   * Parse Text Tokens
   */</span>

  <span class="name">Parser</span>.<span class="name">prototype</span>.<span class="name">parseText</span> <span class="operator">=</span> <span class="keyword">function</span>() {
    var <span class="name">body</span> = this.<span class="name">token</span>.<span class="name">text</span>;

    <span class="keyword">while</span> (this.<span class="name">peek</span>().<span class="name">type</span> <span class="operator">===</span> <span class="string">'text'</span>) {
      <span class="name">body</span> <span class="operator">+=</span> <span class="string">'\n'</span> <span class="operator">+</span> this.<span class="name">next</span>().<span class="name">text</span>;
    }

    <span class="keyword">return</span> this.<span class="name">inline</span>.<span class="name">output</span>(<span class="name">body</span>);
  };

  <span class="comment">/**
   * Parse Current Token
   */</span>

  <span class="name">Parser</span>.<span class="name">prototype</span>.<span class="name">tok</span> <span class="operator">=</span> <span class="keyword">function</span>() {
    <span class="keyword">switch</span> (this.<span class="name">token</span>.<span class="name">type</span>) {
      <span class="keyword">case</span> <span class="string">'space'</span>: {
        <span class="keyword">return</span> <span class="string">''</span>;
      }
      <span class="keyword">case</span> <span class="string">'hr'</span>: {
        <span class="keyword">return</span> this.<span class="name">renderer</span>.<span class="name">hr</span>();
      }
      <span class="keyword">case</span> <span class="string">'heading'</span>: {
        <span class="keyword">return</span> this.<span class="name">renderer</span>.<span class="name">heading</span>(
          this.<span class="name">inline</span>.<span class="name">output</span>(this.<span class="name">token</span>.<span class="name">text</span>),
          this.<span class="name">token</span>.<span class="name">depth</span>,
          this.<span class="name">token</span>.<span class="name">text</span>);
      }
      <span class="keyword">case</span> <span class="string">'code'</span>: {
        <span class="keyword">return</span> this.<span class="name">renderer</span>.<span class="name">code</span>(this.<span class="name">token</span>.<span class="name">text</span>,
          this.<span class="name">token</span>.<span class="name">lang</span>,
          this.<span class="name">token</span>.<span class="name">escaped</span>);
      }
      <span class="keyword">case</span> <span class="string">'table'</span>: {
        var <span class="name">header</span> = <span class="string">''</span>
          , <span class="name">body</span> = <span class="string">''</span>
          , <span class="name">i</span>
          , <span class="name">row</span>
          , <span class="name">cell</span>
          , <span class="name">flags</span>
          , <span class="name">j</span>;

        <span class="comment">// header</span>
        <span class="name">cell</span> <span class="operator">=</span> <span class="string">''</span>;
        <span class="keyword">for</span> (<span class="name">i</span> <span class="operator">=</span> <span class="number">0</span>; <span class="name">i</span> <span class="operator">&lt;</span> this.<span class="name">token</span>.<span class="name">header</span>.<span class="name">length</span>; i++) {
          <span class="name">flags</span> <span class="operator">=</span> { header: <span class="number">true</span>, align: this.<span class="name">token</span>.<span class="name">align</span>[<span class="name">i</span>] };
          <span class="name">cell</span> <span class="operator">+=</span> this.<span class="name">renderer</span>.<span class="name">tablecell</span>(
            this.<span class="name">inline</span>.<span class="name">output</span>(this.<span class="name">token</span>.<span class="name">header</span>[<span class="name">i</span>]),
            { header: <span class="number">true</span>, align: this.<span class="name">token</span>.<span class="name">align</span>[<span class="name">i</span>] }
          );
        }
        <span class="name">header</span> <span class="operator">+=</span> this.<span class="name">renderer</span>.<span class="name">tablerow</span>(<span class="name">cell</span>);

        <span class="keyword">for</span> (<span class="name">i</span> <span class="operator">=</span> <span class="number">0</span>; <span class="name">i</span> <span class="operator">&lt;</span> this.<span class="name">token</span>.<span class="name">cells</span>.<span class="name">length</span>; i++) {
          <span class="name">row</span> <span class="operator">=</span> this.<span class="name">token</span>.<span class="name">cells</span>[<span class="name">i</span>];

          <span class="name">cell</span> <span class="operator">=</span> <span class="string">''</span>;
          <span class="keyword">for</span> (<span class="name">j</span> <span class="operator">=</span> <span class="number">0</span>; <span class="name">j</span> <span class="operator">&lt;</span> <span class="name">row</span>.<span class="name">length</span>; j++) {
            <span class="name">cell</span> <span class="operator">+=</span> this.<span class="name">renderer</span>.<span class="name">tablecell</span>(
              this.<span class="name">inline</span>.<span class="name">output</span>(<span class="name">row</span>[<span class="name">j</span>]),
              { header: <span class="number">false</span>, align: this.<span class="name">token</span>.<span class="name">align</span>[<span class="name">j</span>] }
            );
          }

          <span class="name">body</span> <span class="operator">+=</span> this.<span class="name">renderer</span>.<span class="name">tablerow</span>(<span class="name">cell</span>);
        }
        <span class="keyword">return</span> this.<span class="name">renderer</span>.<span class="name">table</span>(<span class="name">header</span>, <span class="name">body</span>);
      }
      <span class="keyword">case</span> <span class="string">'blockquote_start'</span>: {
        var <span class="name">body</span> = <span class="string">''</span>;

        <span class="keyword">while</span> (this.<span class="name">next</span>().<span class="name">type</span> <span class="operator">!==</span> <span class="string">'blockquote_end'</span>) {
          <span class="name">body</span> <span class="operator">+=</span> this.<span class="name">tok</span>();
        }

        <span class="keyword">return</span> this.<span class="name">renderer</span>.<span class="name">blockquote</span>(<span class="name">body</span>);
      }
      <span class="keyword">case</span> <span class="string">'list_start'</span>: {
        var <span class="name">body</span> = <span class="string">''</span>
          , <span class="name">ordered</span> = this.<span class="name">token</span>.<span class="name">ordered</span>;

        <span class="keyword">while</span> (this.<span class="name">next</span>().<span class="name">type</span> <span class="operator">!==</span> <span class="string">'list_end'</span>) {
          <span class="name">body</span> <span class="operator">+=</span> this.<span class="name">tok</span>();
        }

        <span class="keyword">return</span> this.<span class="name">renderer</span>.<span class="name">list</span>(<span class="name">body</span>, <span class="name">ordered</span>);
      }
      <span class="keyword">case</span> <span class="string">'list_item_start'</span>: {
        var <span class="name">body</span> = <span class="string">''</span>;

        <span class="keyword">while</span> (this.<span class="name">next</span>().<span class="name">type</span> <span class="operator">!==</span> <span class="string">'list_item_end'</span>) {
          <span class="name">body</span> <span class="operator">+=</span> this.<span class="name">token</span>.<span class="name">type</span> <span class="operator">===</span> <span class="string">'text'</span>
            ? this.<span class="name">parseText</span>()
            : this.<span class="name">tok</span>();
        }

        <span class="keyword">return</span> this.<span class="name">renderer</span>.<span class="name">listitem</span>(<span class="name">body</span>);
      }
      <span class="keyword">case</span> <span class="string">'loose_item_start'</span>: {
        var <span class="name">body</span> = <span class="string">''</span>;

        <span class="keyword">while</span> (this.<span class="name">next</span>().<span class="name">type</span> <span class="operator">!==</span> <span class="string">'list_item_end'</span>) {
          <span class="name">body</span> <span class="operator">+=</span> this.<span class="name">tok</span>();
        }

        <span class="keyword">return</span> this.<span class="name">renderer</span>.<span class="name">listitem</span>(<span class="name">body</span>);
      }
      <span class="keyword">case</span> <span class="string">'html'</span>: {
        var <span class="name">html</span> = !this.<span class="name">token</span>.<span class="name">pre</span> <span class="operator">&amp;&amp;</span> !this.<span class="name">options</span>.<span class="name">pedantic</span>
          ? this.<span class="name">inline</span>.<span class="name">output</span>(this.<span class="name">token</span>.<span class="name">text</span>)
          : this.<span class="name">token</span>.<span class="name">text</span>;
        <span class="keyword">return</span> this.<span class="name">renderer</span>.<span class="name">html</span>(<span class="name">html</span>);
      }
      <span class="keyword">case</span> <span class="string">'paragraph'</span>: {
        <span class="keyword">return</span> this.<span class="name">renderer</span>.<span class="name">paragraph</span>(this.<span class="name">inline</span>.<span class="name">output</span>(this.<span class="name">token</span>.<span class="name">text</span>));
      }
      <span class="keyword">case</span> <span class="string">'text'</span>: {
        <span class="keyword">return</span> this.<span class="name">renderer</span>.<span class="name">paragraph</span>(this.<span class="name">parseText</span>());
      }
    }
  };

  <span class="comment">/**
   * Helpers
   */</span>

  <span class="keyword">function</span> <span class="name">escape</span>(<span class="name">html</span>, encode) {
    <span class="keyword">return</span> <span class="name">html</span>
      .<span class="name">replace</span>(!<span class="name">encode</span> ? /&amp;(?!#?\w+;)/g : /&amp;/g, <span class="string">'&amp;amp;'</span>)
      .<span class="name">replace</span>(/&lt;/g, <span class="string">'&amp;lt;'</span>)
      .<span class="name">replace</span>(/&gt;/g, <span class="string">'&amp;gt;'</span>)
      .<span class="name">replace</span>(/&quot;/g, <span class="string">'&amp;quot;'</span>)
      .<span class="name">replace</span>(/'/g, <span class="string">'&amp;#39;'</span>);
  }

  <span class="keyword">function</span> <span class="name">unescape</span>(<span class="name">html</span>) {
          <span class="comment">// explicitly match decimal, hex, and named HTML entities</span>
    <span class="keyword">return</span> <span class="name">html</span>.<span class="name">replace</span>(/&amp;(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/g, <span class="keyword">function</span>(<span class="name">_</span>, n) {
      <span class="name">n</span> <span class="operator">=</span> <span class="name">n</span>.<span class="name">toLowerCase</span>();
      <span class="keyword">if</span> (<span class="name">n</span> <span class="operator">===</span> <span class="string">'colon'</span>) <span class="keyword">return</span> <span class="string">':'</span>;
      <span class="keyword">if</span> (<span class="name">n</span>.<span class="name">charAt</span>(<span class="number">0</span>) <span class="operator">===</span> <span class="string">'#'</span>) {
        <span class="keyword">return</span> <span class="name">n</span>.<span class="name">charAt</span>(<span class="number">1</span>) <span class="operator">===</span> <span class="string">'x'</span>
          ? <span class="name">String</span>.<span class="name">fromCharCode</span>(<span class="name">parseInt</span>(<span class="name">n</span>.<span class="name">substring</span>(<span class="number">2</span>), <span class="number">16</span>))
          : <span class="name">String</span>.<span class="name">fromCharCode</span>(+<span class="name">n</span>.<span class="name">substring</span>(<span class="number">1</span>));
      }
      <span class="keyword">return</span> <span class="string">''</span>;
    });
  }

  <span class="keyword">function</span> <span class="name">replace</span>(<span class="name">regex</span>, opt) {
    <span class="name">regex</span> <span class="operator">=</span> <span class="name">regex</span>.<span class="name">source</span>;
    <span class="name">opt</span> <span class="operator">=</span> <span class="name">opt</span> <span class="operator">||</span> <span class="string">''</span>;
    <span class="keyword">return</span> <span class="keyword">function</span> <span class="name">self</span>(<span class="name">name</span>, val) {
      <span class="keyword">if</span> (!<span class="name">name</span>) <span class="keyword">return</span> new <span class="name">RegExp</span>(<span class="name">regex</span>, <span class="name">opt</span>);
      <span class="name">val</span> <span class="operator">=</span> <span class="name">val</span>.<span class="name">source</span> <span class="operator">||</span> <span class="name">val</span>;
      <span class="name">val</span> <span class="operator">=</span> <span class="name">val</span>.<span class="name">replace</span>(/(^|[^\[])\^/g, <span class="string">'$1'</span>);
      <span class="name">regex</span> <span class="operator">=</span> <span class="name">regex</span>.<span class="name">replace</span>(<span class="name">name</span>, <span class="name">val</span>);
      <span class="keyword">return</span> <span class="name">self</span>;
    };
  }

  <span class="keyword">function</span> <span class="name">noop</span>() {}
  <span class="name">noop</span>.<span class="name">exec</span> <span class="operator">=</span> <span class="name">noop</span>;

  <span class="keyword">function</span> <span class="name">merge</span>(<span class="name">obj</span>) {
    var <span class="name">i</span> = <span class="number">1</span>
      , <span class="name">target</span>
      , <span class="name">key</span>;

    <span class="keyword">for</span> (; <span class="name">i</span> <span class="operator">&lt;</span> <span class="name">arguments</span>.<span class="name">length</span>; i++) {
      <span class="name">target</span> <span class="operator">=</span> <span class="name">arguments</span>[<span class="name">i</span>];
      <span class="keyword">for</span> (<span class="name">key</span> in <span class="name">target</span>) {
        <span class="keyword">if</span> (<span class="name">Object</span>.<span class="name">prototype</span>.<span class="name">hasOwnProperty</span>.<span class="name">call</span>(<span class="name">target</span>, <span class="name">key</span>)) {
          <span class="name">obj</span>[<span class="name">key</span>] <span class="operator">=</span> <span class="name">target</span>[<span class="name">key</span>];
        }
      }
    }

    <span class="keyword">return</span> <span class="name">obj</span>;
  }

  <span class="comment">/**
   * Marked
   */</span>

  <span class="keyword">function</span> <span class="name">marked</span>(<span class="name">src</span>, opt, callback) {
    <span class="keyword">if</span> (<span class="name">callback</span> <span class="operator">||</span> typeof <span class="name">opt</span> <span class="operator">===</span> <span class="string">'function'</span>) {
      <span class="keyword">if</span> (!<span class="name">callback</span>) {
        <span class="name">callback</span> <span class="operator">=</span> <span class="name">opt</span>;
        <span class="name">opt</span> <span class="operator">=</span> <span class="number">null</span>;
      }

      <span class="name">opt</span> <span class="operator">=</span> <span class="name">merge</span>({}, <span class="name">marked</span>.<span class="name">defaults</span>, <span class="name">opt</span> <span class="operator">||</span> {});

      var <span class="name">highlight</span> = <span class="name">opt</span>.<span class="name">highlight</span>
        , <span class="name">tokens</span>
        , <span class="name">pending</span>
        , <span class="name">i</span> = <span class="number">0</span>;

      <span class="keyword">try</span> {
        <span class="name">tokens</span> <span class="operator">=</span> <span class="name">Lexer</span>.<span class="name">lex</span>(<span class="name">src</span>, <span class="name">opt</span>)
      } <span class="keyword">catch</span> (<span class="name">e</span>) {
        return callback(e);
      }

      <span class="name">pending</span> <span class="operator">=</span> <span class="name">tokens</span>.<span class="name">length</span>;

      var <span class="name">done</span> = <span class="keyword">function</span>(<span class="name">err</span>) {
        <span class="keyword">if</span> (<span class="name">err</span>) {
          <span class="name">opt</span>.<span class="name">highlight</span> <span class="operator">=</span> <span class="name">highlight</span>;
          <span class="keyword">return</span> <span class="name">callback</span>(<span class="name">err</span>);
        }

        var <span class="name">out</span>;

        <span class="keyword">try</span> {
          <span class="name">out</span> <span class="operator">=</span> <span class="name">Parser</span>.<span class="name">parse</span>(<span class="name">tokens</span>, <span class="name">opt</span>);
        } <span class="keyword">catch</span> (<span class="name">e</span>) {
          err = e;
        }

        <span class="name">opt</span>.<span class="name">highlight</span> <span class="operator">=</span> <span class="name">highlight</span>;

        <span class="keyword">return</span> <span class="name">err</span>
          ? <span class="name">callback</span>(<span class="name">err</span>)
          : <span class="name">callback</span>(<span class="number">null</span>, <span class="name">out</span>);
      };

      <span class="keyword">if</span> (!<span class="name">highlight</span> <span class="operator">||</span> <span class="name">highlight</span>.<span class="name">length</span> <span class="operator">&lt;</span> <span class="number">3</span>) {
        <span class="keyword">return</span> <span class="name">done</span>();
      }

      delete <span class="name">opt</span>.<span class="name">highlight</span>;

      <span class="keyword">if</span> (!<span class="name">pending</span>) <span class="keyword">return</span> <span class="name">done</span>();

      <span class="keyword">for</span> (; <span class="name">i</span> <span class="operator">&lt;</span> <span class="name">tokens</span>.<span class="name">length</span>; i++) {
        (<span class="keyword">function</span>(<span class="name">token</span>) {
          <span class="keyword">if</span> (<span class="name">token</span>.<span class="name">type</span> <span class="operator">!==</span> <span class="string">'code'</span>) {
            <span class="keyword">return</span> --<span class="name">pending</span> <span class="operator">||</span> <span class="name">done</span>();
          }
          <span class="keyword">return</span> <span class="name">highlight</span>(<span class="name">token</span>.<span class="name">text</span>, <span class="name">token</span>.<span class="name">lang</span>, <span class="keyword">function</span>(<span class="name">err</span>, code) {
            <span class="keyword">if</span> (<span class="name">err</span>) <span class="keyword">return</span> <span class="name">done</span>(<span class="name">err</span>);
            <span class="keyword">if</span> (<span class="name">code</span> <span class="operator">==</span> <span class="number">null</span> <span class="operator">||</span> <span class="name">code</span> <span class="operator">===</span> <span class="name">token</span>.<span class="name">text</span>) {
              <span class="keyword">return</span> --<span class="name">pending</span> <span class="operator">||</span> <span class="name">done</span>();
            }
            <span class="name">token</span>.<span class="name">text</span> <span class="operator">=</span> <span class="name">code</span>;
            <span class="name">token</span>.<span class="name">escaped</span> <span class="operator">=</span> <span class="number">true</span>;
            --<span class="name">pending</span> <span class="operator">||</span> <span class="name">done</span>();
          });
        })(<span class="name">tokens</span>[<span class="name">i</span>]);
      }

      <span class="keyword">return</span>;
    }
    <span class="keyword">try</span> {
      <span class="keyword">if</span> (<span class="name">opt</span>) <span class="name">opt</span> <span class="operator">=</span> <span class="name">merge</span>({}, <span class="name">marked</span>.<span class="name">defaults</span>, <span class="name">opt</span>);
      <span class="keyword">return</span> <span class="name">Parser</span>.<span class="name">parse</span>(<span class="name">Lexer</span>.<span class="name">lex</span>(<span class="name">src</span>, <span class="name">opt</span>), <span class="name">opt</span>);
    } <span class="keyword">catch</span> (<span class="name">e</span>) {
      e.message += '\nPlease report this to https://github.com/chjj/marked.';
      if ((opt || marked.defaults).silent) {
        return '&lt;p&gt;An error occured:&lt;/p&gt;&lt;pre&gt;'
          + escape(e.message + '', true)
          + '&lt;/pre&gt;';
      }
      throw e;
    }
  }

  <span class="comment">/**
   * Options
   */</span>

  <span class="name">marked</span>.<span class="name">options</span> <span class="operator">=</span>
  <span class="name">marked</span>.<span class="name">setOptions</span> <span class="operator">=</span> <span class="keyword">function</span>(<span class="name">opt</span>) {
    <span class="name">merge</span>(<span class="name">marked</span>.<span class="name">defaults</span>, <span class="name">opt</span>);
    <span class="keyword">return</span> <span class="name">marked</span>;
  };

  <span class="name">marked</span>.<span class="name">defaults</span> <span class="operator">=</span> {
    gfm: <span class="number">true</span>,
    tables: <span class="number">true</span>,
    breaks: <span class="number">false</span>,
    pedantic: <span class="number">false</span>,
    sanitize: <span class="number">false</span>,
    sanitizer: <span class="number">null</span>,
    mangle: <span class="number">true</span>,
    smartLists: <span class="number">false</span>,
    silent: <span class="number">false</span>,
    highlight: <span class="number">null</span>,
    langPrefix: <span class="string">'lang-'</span>,
    smartypants: <span class="number">false</span>,
    headerPrefix: <span class="string">''</span>,
    renderer: new <span class="name">Renderer</span>,
    xhtml: <span class="number">false</span>
  };

  <span class="comment">/**
   * Expose
   */</span>

  <span class="name">marked</span>.<span class="name">Parser</span> <span class="operator">=</span> <span class="name">Parser</span>;
  <span class="name">marked</span>.<span class="name">parser</span> <span class="operator">=</span> <span class="name">Parser</span>.<span class="name">parse</span>;

  <span class="name">marked</span>.<span class="name">Renderer</span> <span class="operator">=</span> <span class="name">Renderer</span>;

  <span class="name">marked</span>.<span class="name">Lexer</span> <span class="operator">=</span> <span class="name">Lexer</span>;
  <span class="name">marked</span>.<span class="name">lexer</span> <span class="operator">=</span> <span class="name">Lexer</span>.<span class="name">lex</span>;

  <span class="name">marked</span>.<span class="name">InlineLexer</span> <span class="operator">=</span> <span class="name">InlineLexer</span>;
  <span class="name">marked</span>.<span class="name">inlineLexer</span> <span class="operator">=</span> <span class="name">InlineLexer</span>.<span class="name">output</span>;

  <span class="name">marked</span>.<span class="name">parse</span> <span class="operator">=</span> <span class="name">marked</span>;

  <span class="keyword">if</span> (typeof <span class="name">module</span> <span class="operator">!==</span> <span class="string">'undefined'</span> <span class="operator">&amp;&amp;</span> typeof <span class="name">exports</span> <span class="operator">===</span> <span class="string">'object'</span>) {
    <span class="name">module</span>.<span class="name">exports</span> <span class="operator">=</span> <span class="name">marked</span>;
  } <span class="keyword">else</span> <span class="keyword">if</span> (typeof <span class="name">define</span> <span class="operator">===</span> <span class="string">'function'</span> <span class="operator">&amp;&amp;</span> <span class="name">define</span>.<span class="name">amd</span>) {
    <span class="name">define</span>(<span class="keyword">function</span>() { <span class="keyword">return</span> <span class="name">marked</span>; });
  } <span class="keyword">else</span> {
    this.<span class="name">marked</span> <span class="operator">=</span> <span class="name">marked</span>;
  }

  }).<span class="name">call</span>(<span class="keyword">function</span>() {
    <span class="keyword">return</span> this <span class="operator">||</span> (typeof <span class="name">window</span> <span class="operator">!==</span> <span class="string">'undefined'</span> ? <span class="name">window</span> : <span class="name">global</span>);
  }());

</pre>
</div>
<!-- @@@webengine/recipebrowser/resources/pages/assets/3rdparty/marked.js -->
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <acronym title="Copyright">&copy;</acronym> 2017 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.<br>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.<br>    Qt and respective logos are trademarks of The Qt Company Ltd.     in Finland and/or other countries worldwide. All other trademarks are property
   of their respective owners. </p>
</div>
</body>
</html>
